<!DOCTYPE html>
<html lang="pa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡®ü‡®æ‡®à‡®Æ ‡®ï‡©à‡®≤‡®ï‡©Å‡®≤‡©á‡®ü‡®∞</title>
    <style>
        /* --- ‡®Ü‡®´‡®≤‡®æ‡®à‡®® CSS (Tailwind ‡®¶‡©Ä ‡®®‡®ï‡®≤) --- */
        :root {
            --bg-color: #000000;
            --card-bg: #0f1115; /* gray-950 equivalent */
            --input-bg: #1f2937;
            --input-border: #4b5563;
            --text-white: #ffffff;
            --text-gray: #d1d5db;
            --text-gray-light: #9ca3af;
            --green-primary: #4ade80; /* green-400 */
            --green-dark: #15803d;
            --purple-primary: #c084fc; /* purple-400 */
            --purple-dark: #7e22ce;
            --blue-primary: #60a5fa; /* blue-400 */
            --blue-dark: #1d4ed8;
            --red-error: #ef4444;
            --red-btn: #dc2626;
            --red-btn-hover: #b91c1c;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--bg-color);
            font-family: system-ui, -apple-system, sans-serif;
            color: var(--text-white);
            display: flex;
            justify-content: center;
            padding: 1rem;
            min-height: 100vh;
        }

        main {
            width: 100%;
            max-width: 42rem; /* max-w-2xl */
            display: flex;
            flex-direction: column;
            gap: 2rem; /* space-y-8 */
        }

        /* --- ‡®ï‡®æ‡®∞‡®° ‡®∏‡®ü‡®æ‡®à‡®≤ --- */
        section {
            background-color: var(--card-bg);
            border-radius: 1.5rem; /* rounded-3xl */
            padding: 1.5rem;
            border-width: 2px;
            border-style: solid;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
        }

        /* ‡®¨‡®æ‡®∞‡®°‡®∞ ‡®∞‡©∞‡®ó (‡®ü‡®æ‡®à‡®ü‡®≤ ‡®®‡®æ‡®≤ ‡®Æ‡©à‡®ö‡®ø‡©∞‡®ó) */
        .border-green { border-color: var(--green-primary); }
        .border-purple { border-color: var(--purple-primary); }
        .border-blue { border-color: var(--blue-primary); }
        .border-white { border-color: var(--text-white); }

        h2 {
            font-size: 1.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 1.25rem;
        }

        .text-green { color: var(--green-primary); }
        .text-purple { color: var(--purple-primary); }
        .text-blue { color: var(--blue-primary); }
        .text-white { color: var(--text-white); }

        /* --- ‡®ó‡®∞‡®ø‡©±‡®° ‡®≤‡©á‡®Ü‡®â‡®ü --- */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        @media (min-width: 768px) {
            .grid-2 { grid-template-columns: 1fr 1fr; }
        }

        .grid-5 {
            display: grid;
            grid-template-columns: 2fr 0.5fr 1fr 1fr; /* Adjusted for compact layout */
            gap: 0.5rem;
            align-items: start;
            margin-bottom: 1rem;
        }

        /* --- ‡®á‡®®‡®™‡©Å‡®ü‡®∏ --- */
        label {
            display: block;
            margin-bottom: 0.25rem;
            font-weight: 600;
            font-size: 1rem;
        }
        .label-green { color: #86efac; /* green-300 */ }
        .label-purple { color: #d8b4fe; /* purple-300 */ }
        .label-blue { color: #93c5fd; /* blue-300 */ }
        .label-gray { color: var(--text-gray); font-size: 0.875rem; }

        input[type="text"], input[type="number"], input[type="time"] {
            width: 100%;
            background-color: var(--input-bg);
            border: 1px solid var(--input-border);
            color: var(--text-white);
            padding: 0.75rem;
            border-radius: 0.75rem;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        input:focus {
            outline: none;
            border-color: var(--text-white);
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
        }
        
        .input-green:focus { border-color: var(--green-primary); box-shadow: 0 0 0 2px rgba(74, 222, 128, 0.3); }
        .input-purple:focus { border-color: var(--purple-primary); box-shadow: 0 0 0 2px rgba(192, 132, 252, 0.3); }
        .input-blue:focus { border-color: var(--blue-primary); box-shadow: 0 0 0 2px rgba(96, 165, 250, 0.3); }

        /* ‡®õ‡©ã‡®ü‡©á ‡®á‡®®‡®™‡©Å‡®ü (‡®∏‡©à‡®ï‡®∏‡®º‡®® 4) */
        .input-compact {
            padding: 0.5rem;
            text-align: center;
        }
        .input-compact-left {
            padding: 0.5rem;
            text-align: left;
        }

        /* ‡®ó‡®≤‡®§‡©Ä ‡®¶‡®æ ‡®∏‡®ü‡®æ‡®à‡®≤ */
        .input-error {
            border-color: var(--red-error) !important;
            color: var(--red-error) !important;
        }
        .warning-text {
            color: var(--red-error);
            font-size: 0.875rem;
            margin-top: 0.25rem;
            min-height: 1.25rem;
        }

        /* --- ‡®¨‡®ü‡®® --- */
        .btn {
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.75rem;
            font-weight: 700;
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            transition: opacity 0.2s;
        }
        .btn:hover { opacity: 0.9; }

        .btn-green { background-color: var(--green-dark); }
        .btn-purple { background-color: var(--purple-dark); }
        .btn-blue { background-color: var(--blue-dark); }
        
        .btn-reset {
            background-color: var(--red-btn);
            width: auto;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            margin-top: 1rem;
        }
        .btn-reset:hover { background-color: var(--red-btn-hover); }

        /* --- ‡®Ü‡®â‡®ü‡®™‡©Å‡©±‡®ü ‡®¨‡®æ‡®ï‡®∏ --- */
        .output-box {
            background-color: #111827; /* gray-900 */
            padding: 1rem;
            border-radius: 0.75rem;
            margin-top: 1rem;
            text-align: center;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.5);
        }
        .hidden { display: none; }
        .result-text {
            font-family: monospace;
            font-size: 1.125rem;
            margin-bottom: 0.5rem;
            color: #f3f4f6;
        }
        hr {
            border: 0;
            border-top: 1px solid #374151;
            margin: 0.5rem 0;
        }

        /* --- ‡®ï‡®∏‡®ü‡®Æ ‡®ï‡©à‡®≤‡©∞‡®°‡®∞ ‡®Ü‡®à‡®ï‡®® ‡®∏‡®ø‡®∏‡®ü‡®Æ --- */
        .date-wrapper {
            position: relative;
            width: 100%;
        }
        .calendar-trigger {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: var(--text-gray-light);
            background: none;
            border: none;
            padding: 0;
        }
        /* ‡®á‡®π ‡®Ö‡®∏‡®≤‡©Ä Native Date Input ‡®π‡©à ‡®ú‡©ã ‡®õ‡©Å‡®™‡®ø‡®Ü ‡®π‡©ã‡®á‡®Ü ‡®π‡©à ‡®™‡®∞ ‡®Ü‡®à‡®ï‡®® ‡®¶‡©á ‡®â‡©±‡®™‡®∞ ‡®π‡©à */
        .native-date-picker {
            position: absolute;
            right: 0;
            top: 0;
            width: 3rem;
            height: 100%;
            opacity: 0; /* ‡®Ö‡®¶‡®ø‡©±‡®ñ */
            cursor: pointer;
            z-index: 10;
        }

        /* ‡®§‡©Ä‡®∞ ‡®¶‡®æ ‡®®‡®ø‡®∏‡®º‡®æ‡®® */
        .arrow-icon {
            font-size: 1.875rem; /* 3xl */
            font-weight: 600;
            color: #6b7280;
            text-align: center;
            padding-top: 0.25rem;
        }
    </style>
</head>
<body>
    <main>
        
        <!-- ========================== -->
        <!-- ‡®∏‡©à‡®ï‡®∏‡®º‡®® 1: ‡®§‡®∞‡©Ä‡®ï ‡®¶‡®æ ‡®Ö‡©∞‡®§‡®∞ -->
        <!-- ========================== -->
        <section class="border-green">
            <h2 class="text-green">‡®∏‡©à‡®ï‡®∏‡®º‡®® 1: ‡®§‡®∞‡©Ä‡®ï ‡®¶‡®æ ‡®Ö‡©∞‡®§‡®∞</h2>
            
            <div class="grid-2">
                <div>
                    <label for="s1-date1" class="label-green">‡®∏‡®º‡©Å‡®∞‡©Å‡®Ü‡®§‡©Ä ‡®§‡®∞‡©Ä‡®ï</label>
                    <div class="date-wrapper">
                        <input type="text" id="s1-date1" placeholder="DD-MM-YYYY" inputmode="tel" class="input-green" data-input> 
                        <!-- ‡®Ü‡®´‡®≤‡®æ‡®à‡®® ‡®ï‡©à‡®≤‡©∞‡®°‡®∞ ‡®ü‡©ç‡®∞‡®ø‡®ï -->
                        <button class="calendar-trigger">üìÖ</button>
                        <input type="date" class="native-date-picker" data-target="s1-date1">
                    </div>
                    <p id="s1-date1-warning" class="warning-text"></p>
                </div>
                <div>
                    <label for="s1-date2" class="label-green">‡®Ö‡©∞‡®§‡®ø‡®Æ ‡®§‡®∞‡©Ä‡®ï</label>
                    <div class="date-wrapper">
                        <input type="text" id="s1-date2" placeholder="DD-MM-YYYY" inputmode="tel" class="input-green" data-input>
                        <button class="calendar-trigger">üìÖ</button>
                        <input type="date" class="native-date-picker" data-target="s1-date2">
                    </div>
                    <p id="s1-date2-warning" class="warning-text"></p>
                </div>
            </div>
            <button id="calc1" class="btn btn-green">‡®ó‡®£‡®®‡®æ ‡®ï‡®∞‡©ã</button>
            <div id="output-box1" class="output-box hidden">
                <p id="result1" class="result-text"></p>
                <button id="reset1" class="btn btn-reset">‡®∞‡©Ä‡®∏‡©à‡©±‡®ü</button>
            </div>
        </section>
        
        <!-- ========================== -->
        <!-- ‡®∏‡©à‡®ï‡®∏‡®º‡®® 2: ‡®∏‡®Æ‡©á‡®Ç ‡®¶‡®æ ‡®Ö‡©∞‡®§‡®∞ -->
        <!-- ========================== -->
        <section class="border-purple">
            <h2 class="text-purple">‡®∏‡©à‡®ï‡®∏‡®º‡®® 2: ‡®∏‡®Æ‡©á‡®Ç ‡®¶‡®æ ‡®Ö‡©∞‡®§‡®∞</h2>
            <div class="grid-2">
                <div>
                    <label for="s2-time1" class="label-purple">‡®∏‡®º‡©Å‡®∞‡©Å‡®Ü‡®§‡©Ä ‡®∏‡®Æ‡®æ‡®Ç (HH:MM)</label>
                    <input type="time" id="s2-time1" class="input-purple" required>
                </div>
                <div>
                    <label for="s2-time2" class="label-purple">‡®Ö‡©∞‡®§‡®ø‡®Æ ‡®∏‡®Æ‡®æ‡®Ç (HH:MM)</label>
                    <input type="time" id="s2-time2" class="input-purple" required>
                </div>
            </div>
            <button id="calc2" class="btn btn-purple">‡®ó‡®£‡®®‡®æ ‡®ï‡®∞‡©ã</button>
            <div id="output-box2" class="output-box hidden">
                <p id="result2" class="result-text"></p>
                <button id="reset2" class="btn btn-reset">‡®∞‡©Ä‡®∏‡©à‡©±‡®ü</button>
            </div>
        </section>
        
        <!-- ========================== -->
        <!-- ‡®∏‡©à‡®ï‡®∏‡®º‡®® 3: ‡®ï‡©Å‡©±‡®≤ ‡®Ö‡©∞‡®§‡®∞ -->
        <!-- ========================== -->
        <section class="border-blue">
            <h2 class="text-blue">‡®∏‡©à‡®ï‡®∏‡®º‡®® 3: ‡®ï‡©Å‡©±‡®≤ ‡®Ö‡©∞‡®§‡®∞</h2>
            <div class="grid-2">
                <div>
                    <label for="s3-date1" class="label-blue">‡®∏‡®º‡©Å‡®∞‡©Å‡®Ü‡®§‡©Ä ‡®§‡®∞‡©Ä‡®ï</label>
                    <div class="date-wrapper">
                        <input type="text" id="s3-date1" placeholder="DD-MM-YYYY" inputmode="tel" class="input-blue" data-input>
                        <button class="calendar-trigger">üìÖ</button>
                        <input type="date" class="native-date-picker" data-target="s3-date1">
                    </div>
                    <p id="s3-date1-warning" class="warning-text"></p>
                </div>
                <div>
                    <label for="s3-time1" class="label-blue">‡®∏‡®º‡©Å‡®∞‡©Å‡®Ü‡®§‡©Ä ‡®∏‡®Æ‡®æ‡®Ç (HH:MM)</label>
                    <input type="time" id="s3-time1" class="input-blue" required>
                </div>
                <div>
                    <label for="s3-date2" class="label-blue">‡®Ö‡©∞‡®§‡®ø‡®Æ ‡®§‡®∞‡©Ä‡®ï</label>
                    <div class="date-wrapper">
                        <input type="text" id="s3-date2" placeholder="DD-MM-YYYY" inputmode="tel" class="input-blue" data-input>
                        <button class="calendar-trigger">üìÖ</button>
                        <input type="date" class="native-date-picker" data-target="s3-date2">
                    </div>
                    <p id="s3-date2-warning" class="warning-text"></p>
                </div>
                <div>
                    <label for="s3-time2" class="label-blue">‡®Ö‡©∞‡®§‡®ø‡®Æ ‡®∏‡®Æ‡®æ‡®Ç (HH:MM)</label>
                    <input type="time" id="s3-time2" class="input-blue" required>
                </div>
            </div>
            <button id="calc3" class="btn btn-blue">‡®ó‡®£‡®®‡®æ ‡®ï‡®∞‡©ã</button>
            <div id="output-box3" class="output-box hidden">
                <p id="result3-ymd" class="result-text"></p>
                <p id="result3-hms" class="result-text"></p>
                <hr>
                <p id="result3-total-dhm" class="result-text" style="font-size: 1rem;"></p>
                <p id="result3-total_h" class="result-text" style="font-size: 1rem;"></p>
                <button id="reset3" class="btn btn-reset">‡®∞‡©Ä‡®∏‡©à‡©±‡®ü</button>
            </div>
        </section>

        <!-- ========================== -->
        <!-- ‡®∏‡©à‡®ï‡®∏‡®º‡®® 4: ‡®Ø‡©Ç‡®®‡®ø‡®ü ‡®ï‡®®‡®µ‡®∞‡®ü‡®∞ -->
        <!-- ========================== -->
        <section class="border-white">
            <h2 class="text-white">‡®∏‡©à‡®ï‡®∏‡®º‡®® 4: ‡®Ø‡©Ç‡®®‡®ø‡®ü ‡®ï‡®®‡®µ‡®∞‡®ü‡®∞</h2>
            
            <!-- ‡®ï‡®®‡®µ‡®∞‡®ü‡®∞ 1: ‡®Æ‡®ø‡©∞‡®ü <-> ‡®ò‡©∞‡®ü‡©á:‡®Æ‡®ø‡©∞‡®ü -->
            <div class="grid-5">
                <div>
                    <label for="s4_h_m_total_minutes" class="label-gray">‡®ï‡©Å‡©±‡®≤ ‡®Æ‡®ø‡©∞‡®ü</label>
                    <input type="number" id="s4_h_m_total_minutes" placeholder="0" inputmode="numeric" class="input-compact-left">
                </div>
                <div class="arrow-icon">&harr;</div>
                <div>
                    <label for="s4_h_m_hours" class="label-gray">‡®ò‡©∞‡®ü‡©á</label>
                    <input type="number" id="s4_h_m_hours" placeholder="0" inputmode="numeric" class="input-compact">
                </div>
                <div>
                    <label for="s4_h_m_minutes" class="label-gray">‡®Æ‡®ø‡©∞‡®ü</label>
                    <input type="number" id="s4_h_m_minutes" placeholder="0" inputmode="numeric" class="input-compact">
                    <p id="s4_h_m_minutes-warning" class="warning-text text-center"></p>
                </div>
            </div>
            
            <!-- ‡®ï‡®®‡®µ‡®∞‡®ü‡®∞ 2: ‡®ò‡©∞‡®ü‡©á <-> ‡®¶‡®ø‡®®:‡®ò‡©∞‡®ü‡©á -->
            <div class="grid-5">
                <div>
                    <label for="s4_d_h_total_hours" class="label-gray">‡®ï‡©Å‡©±‡®≤ ‡®ò‡©∞‡®ü‡©á</label>
                    <input type="number" id="s4_d_h_total_hours" placeholder="0" inputmode="numeric" class="input-compact-left">
                </div>
                <div class="arrow-icon">&harr;</div>
                <div>
                    <label for="s4_d_h_days" class="label-gray">‡®¶‡®ø‡®®</label>
                    <input type="number" id="s4_d_h_days" placeholder="0" inputmode="numeric" class="input-compact">
                </div>
                <div>
                    <label for="s4_d_h_hours" class="label-gray">‡®ò‡©∞‡®ü‡©á</label>
                    <input type="number" id="s4_d_h_hours" placeholder="0" inputmode="numeric" class="input-compact">
                    <p id="s4_d_h_hours-warning" class="warning-text text-center"></p>
                </div>
            </div>

            <!-- ‡®ï‡®®‡®µ‡®∞‡®ü‡®∞ 3: ‡®π‡®´‡®§‡©á <-> ‡®Æ‡®π‡©Ä‡®®‡©á:‡®π‡®´‡®§‡©á -->
            <div class="grid-5">
                <div>
                    <label for="s4_m_w_total_weeks" class="label-gray">‡®ï‡©Å‡©±‡®≤ ‡®π‡®´‡®§‡©á</label>
                    <input type="number" id="s4_m_w_total_weeks" placeholder="0" inputmode="numeric" class="input-compact-left">
                </div>
                <div class="arrow-icon">&harr;</div>
                <div>
                    <label for="s4_m_w_months" class="label-gray">‡®Æ‡®π‡©Ä‡®®‡©á</label>
                    <input type="number" id="s4_m_w_months" placeholder="0" inputmode="numeric" class="input-compact">
                </div>
                <div>
                    <label for="s4_m_w_weeks" class="label-gray">‡®π‡®´‡®§‡©á</label>
                    <input type="number" id="s4_m_w_weeks" placeholder="0" inputmode="numeric" class="input-compact">
                    <p id="s4_m_w_weeks-warning" class="warning-text text-center"></p>
                </div>
            </div>

            <!-- ‡®ï‡®®‡®µ‡®∞‡®ü‡®∞ 4: ‡®Æ‡®π‡©Ä‡®®‡©á <-> ‡®∏‡®æ‡®≤:‡®Æ‡®π‡©Ä‡®®‡©á -->
            <div class="grid-5">
                <div>
                    <label for="s4_y_m_total_months" class="label-gray">‡®ï‡©Å‡©±‡®≤ ‡®Æ‡®π‡©Ä‡®®‡©á</label>
                    <input type="number" id="s4_y_m_total_months" placeholder="0" inputmode="numeric" class="input-compact-left">
                </div>
                <div class="arrow-icon">&harr;</div>
                <div>
                    <label for="s4_y_m_years" class="label-gray">‡®∏‡®æ‡®≤</label>
                    <input type="number" id="s4_y_m_years" placeholder="0" inputmode="numeric" class="input-compact">
                </div>
                <div>
                    <label for="s4_y_m_months" class="label-gray">‡®Æ‡®π‡©Ä‡®®‡©á</label>
                    <input type="number" id="s4_y_m_months" placeholder="0" inputmode="numeric" class="input-compact">
                    <p id="s4_y_m_months-warning" class="warning-text text-center"></p>
                </div>
            </div>

            <div style="text-align: center;">
                <button id="reset4" class="btn btn-reset">‡®∞‡©Ä‡®∏‡©à‡©±‡®ü</button>
            </div>
        </section>

    </main>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- ‡®®‡©á‡®ü‡®ø‡®µ ‡®ï‡©à‡®≤‡©∞‡®°‡®∞ ‡®π‡©à‡®Ç‡®°‡®≤‡®∞ (Offline Alternative to Flatpickr) ---
            document.querySelectorAll('.native-date-picker').forEach(picker => {
                picker.addEventListener('change', (e) => {
                    const targetId = e.target.getAttribute('data-target');
                    const textInput = document.getElementById(targetId);
                    // YYYY-MM-DD ‡®®‡©Ç‡©∞ DD-MM-YYYY ‡®µ‡®ø‡©±‡®ö ‡®¨‡®¶‡®≤‡©ã
                    const parts = e.target.value.split('-');
                    if (parts.length === 3) {
                        textInput.value = `${parts[2]}-${parts[1]}-${parts[0]}`;
                        // Trigger input event for validation
                        textInput.dispatchEvent(new Event('input'));
                    }
                });
            });

            // --- ‡®∏‡©à‡®ï‡®∏‡®º‡®® 1-3 ‡®≤‡®à ‡®á‡®®‡®™‡©Å‡®ü ‡®µ‡©à‡®≤‡©Ä‡®°‡©á‡®∂‡®® ---
            document.querySelectorAll('input[data-input]').forEach(input => {
                input.addEventListener('input', (e) => {
                    if (!e.isTrusted) return; 
                    const target = e.target;
                    const originalValue = target.value;
                    let value = originalValue.replace(/[^\d]/g, ''); 
                    let formattedValue = '';
                    if (value.length > 0) {
                        if (value.length <= 2) { formattedValue = value; } 
                        else if (value.length <= 4) { formattedValue = `${value.substring(0, 2)}-${value.substring(2)}`; } 
                        else { formattedValue = `${value.substring(0, 2)}-${value.substring(2, 4)}-${value.substring(4, 8)}`; }
                    }
                    if (originalValue !== formattedValue) { target.value = formattedValue; }
                    const warningElement = document.getElementById(target.id + '-warning');
                    if (!warningElement) return; 
                    warningElement.textContent = ''; 
                    const parts = formattedValue.split('-');
                    let dayError = false, monthError = false, dateInvalidError = false; 
                    let invalidErrorMsg = "", dayNum = 0, monthNum = 0;
                    if (parts[0] && parts[0].length > 0) {
                        dayNum = parseInt(parts[0]);
                        if (dayNum > 31 || (parts[0].length === 2 && dayNum === 0)) { dayError = true; }
                    }
                    if (parts[1] && parts[1].length > 0) {
                        monthNum = parseInt(parts[1]);
                        if (monthNum > 12 || (parts[1].length === 2 && monthNum === 0)) { monthError = true; }
                    }
                    if (!dayError && !monthError && dayNum > 0 && monthNum > 0 && parts[1].length === 2) {
                        const shortMonths = [4, 6, 9, 11]; 
                        if (dayNum === 31 && shortMonths.includes(monthNum)) {
                            dateInvalidError = true; invalidErrorMsg = "‡®á‡®∏ ‡®Æ‡®π‡©Ä‡®®‡©á ‡®µ‡®ø‡©±‡®ö 31 ‡®§‡®∞‡©Ä‡®ï ‡®®‡®π‡©Ä‡®Ç ‡®π‡©Å‡©∞‡®¶‡©Ä‡•§";
                        }
                        if (monthNum === 2 && dayNum > 29) { 
                            dateInvalidError = true; invalidErrorMsg = "‡®´‡®∞‡®µ‡®∞‡©Ä ‡®µ‡®ø‡©±‡®ö 29 ‡®§‡©ã‡®Ç ‡®µ‡©±‡®ß ‡®¶‡®ø‡®® ‡®®‡®π‡©Ä‡®Ç ‡®π‡©Å‡©∞‡®¶‡©á‡•§";
                        }
                    }
                    if (dayError) { warningElement.textContent = "‡®¶‡®ø‡®® 01-31"; } 
                    else if (monthError) { warningElement.textContent = "‡®Æ‡®π‡©Ä‡®®‡®æ 01-12"; } 
                    else if (dateInvalidError) { warningElement.textContent = invalidErrorMsg; }
                });
            });

            // --- Helper Functions (Date/Time Parsing) ---
            function parseDate(dateStr) {
                if (!dateStr || dateStr.length < 10) return null; 
                const parts = dateStr.split('-');
                if (parts.length !== 3) return null;
                if (parts.some(p => isNaN(Number(p)) || p === '')) return null;
                const [day, month, year] = parts.map(Number);
                if (month < 1 || month > 12 || day < 1 || day > 31 || year < 1000 || year > 9999) return null;
                const dateObj = new Date(year, month - 1, day);
                if (dateObj.getFullYear() !== year || dateObj.getMonth() !== (month - 1) || dateObj.getDate() !== day) {
                    return null;
                }
                return dateObj;
            }
            function parseTime(timeStr) {
                if (!timeStr) return null; 
                const parts = timeStr.split(':');
                if (parts.length !== 2 || parts.some(p => p === '' || isNaN(p))) return null; 
                const h = parseInt(parts[0]), m = parseInt(parts[1]);
                if (h < 0 || h > 23 || m < 0 || m > 59) return null; 
                return { h, m, s: 0 };
            }
            function daysInMonth(year, month) {
                return new Date(year, month + 1, 0).getDate();
            }
            
            // --- ‡®∏‡©à‡®ï‡®∏‡®º‡®® 1-3: UI ‡®§‡©±‡®§ ‡®Ö‡®§‡©á ‡®à‡®µ‡©à‡®Ç‡®ü ‡®≤‡®ø‡®∏‡®®‡®∞ ---
            const s1_date1 = document.getElementById('s1-date1'), s1_date2 = document.getElementById('s1-date2');
            const calc1_btn = document.getElementById('calc1'), result1 = document.getElementById('result1');
            const output_box1 = document.getElementById('output-box1'), reset1_btn = document.getElementById('reset1');
            const s2_time1 = document.getElementById('s2-time1'), s2_time2 = document.getElementById('s2-time2');
            const calc2_btn = document.getElementById('calc2'), result2 = document.getElementById('result2');
            const output_box2 = document.getElementById('output-box2'), reset2_btn = document.getElementById('reset2');
            const s3_date1 = document.getElementById('s3-date1'), s3_date2 = document.getElementById('s3-date2');
            const s3_time1 = document.getElementById('s3-time1'), s3_time2 = document.getElementById('s3-time2');
            const calc3_btn = document.getElementById('calc3'), output_box3 = document.getElementById('output-box3');
            const result3_ymd = document.getElementById('result3-ymd'), result3_hms = document.getElementById('result3-hms');
            const result3_total_dhm = document.getElementById('result3-total-dhm'), result3_total_h = document.getElementById('result3-total_h');
            const reset3_btn = document.getElementById('reset3');
            
            // ‡®∏‡©à‡®ï‡®∏‡®º‡®® 1: ‡®ó‡®£‡®®‡®æ
            calc1_btn.addEventListener('click', () => {
                document.getElementById('s1-date1-warning').textContent = '';
                document.getElementById('s1-date2-warning').textContent = '';
                const d1 = parseDate(s1_date1.value), d2 = parseDate(s1_date2.value);
                if (!d1 || !d2) {
                    result1.textContent = "‡®§‡®∞‡©Ä‡®ï ‡®∏‡®π‡©Ä ‡®≠‡®∞‡©ã (‡®ú‡®ø‡®µ‡©á‡®Ç 29-02-2023 ‡®ó‡®≤‡®§ ‡®π‡©à)";
                    output_box1.classList.remove('hidden'); return;
                }
                let startDate = d1 < d2 ? d1 : d2, endDate = d1 > d2 ? d1 : d2;
                let years = endDate.getFullYear() - startDate.getFullYear();
                let months = endDate.getMonth() - startDate.getMonth();
                let days = endDate.getDate() - startDate.getDate();
                if (days < 0) { months--; days += daysInMonth(startDate.getFullYear(), startDate.getMonth()); }
                if (months < 0) { years--; months += 12; }
                result1.textContent = `‡®Ö‡©∞‡®§‡®∞: ${years} ‡®∏‡®æ‡®≤ ${months} ‡®Æ‡®π‡©Ä‡®®‡©á ${days} ‡®¶‡®ø‡®®`;
                output_box1.classList.remove('hidden');
            });
            reset1_btn.addEventListener('click', () => {
                s1_date1.value = ''; s1_date2.value = '';
                result1.textContent = ''; output_box1.classList.add('hidden');
                document.getElementById('s1-date1-warning').textContent = '';
                document.getElementById('s1-date2-warning').textContent = '';
            });
            
            // ‡®∏‡©à‡®ï‡®∏‡®º‡®® 2: ‡®ó‡®£‡®®‡®æ
            calc2_btn.addEventListener('click', () => {
                const t1 = parseTime(s2_time1.value), t2 = parseTime(s2_time2.value);
                if (!t1 || !t2) {
                    result2.textContent = "‡®∏‡®Æ‡®æ‡®Ç ‡®∏‡®π‡©Ä ‡®≠‡®∞‡©ã";
                    output_box2.classList.remove('hidden'); return;
                }
                let totalSeconds1 = t1.h * 3600 + t1.m * 60;
                let totalSeconds2 = t2.h * 3600 + t2.m * 60;
                let diffSeconds = Math.abs(totalSeconds1 - totalSeconds2);
                let h = Math.floor(diffSeconds / 3600);
                diffSeconds %= 3600;
                let m = Math.floor(diffSeconds / 60);
                result2.textContent = `‡®Ö‡©∞‡®§‡®∞: ${h} ‡®ò‡©∞‡®ü‡©á ${m} ‡®Æ‡®ø‡©∞‡®ü`;
                output_box2.classList.remove('hidden');
            });
            reset2_btn.addEventListener('click', () => {
                s2_time1.value = ''; s2_time2.value = '';
                result2.textContent = ''; output_box2.classList.add('hidden');
            });
            
            // ‡®∏‡©à‡®ï‡®∏‡®º‡®® 3: ‡®ó‡®£‡®®‡®æ
            calc3_btn.addEventListener('click', () => {
                document.getElementById('s3-date1-warning').textContent = '';
                document.getElementById('s3-date2-warning').textContent = '';
                const d1 = parseDate(s3_date1.value), d2 = parseDate(s3_date2.value);
                if (!d1 || !d2) {
                    result3_ymd.textContent = "‡®§‡®∞‡©Ä‡®ï ‡®∏‡®π‡©Ä ‡®≠‡®∞‡©ã";
                    result3_hms.textContent = ""; result3_total_dhm.textContent = ""; result3_total_h.textContent = "";
                    output_box3.classList.remove('hidden'); return;
                }
                const t1 = parseTime(s3_time1.value), t2 = parseTime(s3_time2.value);
                if (!t1 || !t2) {
                    result3_ymd.textContent = "‡®∏‡®Æ‡®æ‡®Ç ‡®∏‡®π‡©Ä ‡®≠‡®∞‡©ã";
                    result3_hms.textContent = ""; result3_total_dhm.textContent = ""; result3_total_h.textContent = "";
                    output_box3.classList.remove('hidden'); return;
                }
                const dt1 = new Date(d1.getFullYear(), d1.getMonth(), d1.getDate(), t1.h, t1.m);
                const dt2 = new Date(d2.getFullYear(), d2.getMonth(), d2.getDate(), t2.h, t2.m);
                let startDate = dt1 < dt2 ? dt1 : dt2, endDate = dt1 > d2 ? dt1 : dt2;
                let diffMs = Math.abs(dt2 - dt1);
                let years = endDate.getFullYear() - startDate.getFullYear();
                let months = endDate.getMonth() - startDate.getMonth();
                let days = endDate.getDate() - startDate.getDate();
                let hours = endDate.getHours() - startDate.getHours();
                let minutes = endDate.getMinutes() - startDate.getMinutes();
                if (minutes < 0) { hours--; minutes += 60; }
                if (hours < 0) { days--; hours += 24; }
                if (days < 0) { months--; days += daysInMonth(startDate.getFullYear(), startDate.getMonth()); }
                if (months < 0) { years--; months += 12; }
                result3_ymd.textContent = `‡®Ö‡©∞‡®§‡®∞: ${years} ‡®∏‡®æ‡®≤ ${months} ‡®Æ‡®π‡©Ä‡®®‡©á ${days} ‡®¶‡®ø‡®®`;
                result3_hms.textContent = `‡®Ö‡®§‡©á ${hours} ‡®ò‡©∞‡®ü‡©á ${minutes} ‡®Æ‡®ø‡©∞‡®ü`;
                let totalDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
                let remMs = diffMs % (1000 * 60 * 60 * 24);
                let totalHours = Math.floor(remMs / (1000 * 60 * 60));
                remMs %= (1000 * 60 * 60);
                let totalMinutes = Math.floor(remMs / (1000 * 60));
                result3_total_dhm.textContent = `‡®ï‡©Å‡©±‡®≤: ${totalDays} ‡®¶‡®ø‡®®, ${totalHours} ‡®ò‡©∞‡®ü‡©á ‡®Ö‡®§‡©á ${totalMinutes} ‡®Æ‡®ø‡©∞‡®ü`;
                let totalHoursOnly = (diffMs / (1000 * 60 * 60)).toFixed(2);
                result3_total_h.textContent = `‡®ú‡®æ‡®Ç ‡®ï‡©Å‡©±‡®≤ ${totalHoursOnly} ‡®ò‡©∞‡®ü‡©á`;
                output_box3.classList.remove('hidden');
            });
            reset3_btn.addEventListener('click', () => {
                s3_date1.value = ''; s3_date2.value = ''; s3_time1.value = ''; s3_time2.value = '';
                result3_ymd.textContent = ''; result3_hms.textContent = '';
                result3_total_dhm.textContent = ''; result3_total_h.textContent = '';
                output_box3.classList.add('hidden');
                document.getElementById('s3-date1-warning').textContent = '';
                document.getElementById('s3-date2-warning').textContent = '';
            });

            // --- ‡®∏‡©à‡®ï‡®∏‡®º‡®® 4: ‡®Ø‡©Ç‡®®‡®ø‡®ü ‡®ï‡®®‡®µ‡®∞‡®ü‡®∞ (‡®®‡®µ‡©Ä‡®Ç ‡®µ‡®æ‡®∞‡®®‡®ø‡©∞‡®ó ‡®≤‡®æ‡®ú‡®ø‡®ï) ---

            let isUpdating = false;

            // ‡®§‡©±‡®§ (H/M)
            const s4_h_m_hours = document.getElementById('s4_h_m_hours');
            const s4_h_m_minutes = document.getElementById('s4_h_m_minutes');
            const s4_h_m_total_minutes = document.getElementById('s4_h_m_total_minutes');
            const s4_h_m_minutes_warning = document.getElementById('s4_h_m_minutes-warning');

            // ‡®§‡©±‡®§ (D/H)
            const s4_d_h_days = document.getElementById('s4_d_h_days');
            const s4_d_h_hours = document.getElementById('s4_d_h_hours');
            const s4_d_h_total_hours = document.getElementById('s4_d_h_total_hours');
            const s4_d_h_hours_warning = document.getElementById('s4_d_h_hours-warning');
            
            // ‡®§‡©±‡®§ (M/W) - ‡®®‡®µ‡®æ‡®Ç
            const s4_m_w_months = document.getElementById('s4_m_w_months');
            const s4_m_w_weeks = document.getElementById('s4_m_w_weeks');
            const s4_m_w_total_weeks = document.getElementById('s4_m_w_total_weeks');
            const s4_m_w_weeks_warning = document.getElementById('s4_m_w_weeks-warning');

            // ‡®§‡©±‡®§ (Y/M)
            const s4_y_m_years = document.getElementById('s4_y_m_years');
            const s4_y_m_months = document.getElementById('s4_y_m_months');
            const s4_y_m_total_months = document.getElementById('s4_y_m_total_months');
            const s4_y_m_months_warning = document.getElementById('s4_y_m_months-warning');

            const reset4_btn = document.getElementById('reset4');
            
            // 1. ‡®ò‡©∞‡®ü‡©á <-> ‡®Æ‡®ø‡©∞‡®ü ‡®≤‡®æ‡®ú‡®ø‡®ï
            function updateHMFromCompound() {
                if (isUpdating) return;
                isUpdating = true;
                
                let hours = parseInt(s4_h_m_hours.value) || 0;
                let minutes = parseInt(s4_h_m_minutes.value) || 0;
                
                if (minutes > 60) {
                    s4_h_m_minutes.classList.add('input-error');
                    s4_h_m_minutes_warning.textContent = "‡®Æ‡®ø‡©∞‡®ü 60 ‡®§‡©ã‡®Ç ‡®µ‡©±‡®ß ‡®®‡®π‡©Ä‡®Ç ‡®π‡©ã ‡®∏‡®ï‡®¶‡©á";
                } else {
                    s4_h_m_minutes.classList.remove('input-error');
                    s4_h_m_minutes_warning.textContent = "";
                }

                if (document.activeElement !== s4_h_m_total_minutes) {
                    s4_h_m_total_minutes.value = (hours * 60) + minutes;
                }
                isUpdating = false;
            }
            function updateHMFromTotal() {
                if (isUpdating) return;
                isUpdating = true;
                
                s4_h_m_minutes.classList.remove('input-error');
                s4_h_m_minutes_warning.textContent = "";

                const totalMinutes = parseInt(s4_h_m_total_minutes.value) || 0;
                if (document.activeElement !== s4_h_m_hours) {
                    s4_h_m_hours.value = Math.floor(totalMinutes / 60);
                }
                if (document.activeElement !== s4_h_m_minutes) {
                    s4_h_m_minutes.value = totalMinutes % 60;
                }
                isUpdating = false;
            }
            s4_h_m_hours.addEventListener('input', updateHMFromCompound);
            s4_h_m_minutes.addEventListener('input', updateHMFromCompound);
            s4_h_m_total_minutes.addEventListener('input', updateHMFromTotal);

            // 2. ‡®¶‡®ø‡®® <-> ‡®ò‡©∞‡®ü‡©á ‡®≤‡®æ‡®ú‡®ø‡®ï
            function updateDHFromCompound() {
                if (isUpdating) return;
                isUpdating = true;
                
                let days = parseInt(s4_d_h_days.value) || 0;
                let hours = parseInt(s4_d_h_hours.value) || 0;

                if (hours > 23) { 
                    s4_d_h_hours.classList.add('input-error');
                    s4_d_h_hours_warning.textContent = "‡®ò‡©∞‡®ü‡©á 23 ‡®§‡©ã‡®Ç ‡®µ‡©±‡®ß ‡®®‡®π‡©Ä‡®Ç ‡®π‡©ã ‡®∏‡®ï‡®¶‡©á";
                } else {
                    s4_d_h_hours.classList.remove('input-error');
                    s4_d_h_hours_warning.textContent = "";
                }

                if (document.activeElement !== s4_d_h_total_hours) {
                    s4_d_h_total_hours.value = (days * 24) + hours; 
                }
                isUpdating = false;
            }
            function updateDHFromTotal() {
                if (isUpdating) return;
                isUpdating = true;
                
                s4_d_h_hours.classList.remove('input-error');
                s4_d_h_hours_warning.textContent = "";

                const totalHours = parseInt(s4_d_h_total_hours.value) || 0;
                if (document.activeElement !== s4_d_h_days) {
                    s4_d_h_days.value = Math.floor(totalHours / 24);
                }
                if (document.activeElement !== s4_d_h_hours) {
                    s4_d_h_hours.value = totalHours % 24;
                }
                isUpdating = false;
            }
            s4_d_h_days.addEventListener('input', updateDHFromCompound);
            s4_d_h_hours.addEventListener('input', updateDHFromCompound);
            s4_d_h_total_hours.addEventListener('input', updateDHFromTotal);

            // 3. ‡®Æ‡®π‡©Ä‡®®‡©á <-> ‡®π‡®´‡®§‡©á ‡®≤‡®æ‡®ú‡®ø‡®ï (‡®®‡®µ‡®æ‡®Ç)
            function updateMWFromCompound() {
                if (isUpdating) return;
                isUpdating = true;

                let months = parseInt(s4_m_w_months.value) || 0;
                let weeks = parseInt(s4_m_w_weeks.value) || 0;

                if (weeks > 4) {
                    s4_m_w_weeks.classList.add('input-error');
                    s4_m_w_weeks_warning.textContent = "‡®π‡®´‡®§‡©á 4 ‡®§‡©ã‡®Ç ‡®µ‡©±‡®ß ‡®®‡®π‡©Ä‡®Ç ‡®π‡©ã ‡®∏‡®ï‡®¶‡©á";
                } else {
                    s4_m_w_weeks.classList.remove('input-error');
                    s4_m_w_weeks_warning.textContent = "";
                }
                
                // ‡®á‡©±‡®•‡©á 1 ‡®Æ‡®π‡©Ä‡®®‡®æ = 4 ‡®π‡®´‡®§‡©á ‡®Æ‡©∞‡®®‡®ø‡®Ü ‡®ó‡®ø‡®Ü ‡®π‡©à
                if (document.activeElement !== s4_m_w_total_weeks) {
                    s4_m_w_total_weeks.value = (months * 4) + weeks;
                }
                isUpdating = false;
            }
            function updateMWFromTotal() {
                if (isUpdating) return;
                isUpdating = true;
                
                s4_m_w_weeks.classList.remove('input-error');
                s4_m_w_weeks_warning.textContent = "";

                const totalWeeks = parseInt(s4_m_w_total_weeks.value) || 0;
                if (document.activeElement !== s4_m_w_months) {
                    s4_m_w_months.value = Math.floor(totalWeeks / 4);
                }
                if (document.activeElement !== s4_m_w_weeks) {
                    s4_m_w_weeks.value = totalWeeks % 4;
                }
                isUpdating = false;
            }
            s4_m_w_months.addEventListener('input', updateMWFromCompound);
            s4_m_w_weeks.addEventListener('input', updateMWFromCompound);
            s4_m_w_total_weeks.addEventListener('input', updateMWFromTotal);

            // 4. ‡®∏‡®æ‡®≤ <-> ‡®Æ‡®π‡©Ä‡®®‡©á ‡®≤‡®æ‡®ú‡®ø‡®ï
            function updateYMFromCompound() {
                if (isUpdating) return;
                isUpdating = true;

                let years = parseInt(s4_y_m_years.value) || 0;
                let months = parseInt(s4_y_m_months.value) || 0;

                if (months > 12) {
                    s4_y_m_months.classList.add('input-error');
                    s4_y_m_months_warning.textContent = "‡®Æ‡®π‡©Ä‡®®‡©á 12 ‡®§‡©ã‡®Ç ‡®µ‡©±‡®ß ‡®®‡®π‡©Ä‡®Ç ‡®π‡©ã ‡®∏‡®ï‡®¶‡©á";
                } else {
                    s4_y_m_months.classList.remove('input-error');
                    s4_y_m_months_warning.textContent = "";
                }
                
                if (document.activeElement !== s4_y_m_total_months) {
                    s4_y_m_total_months.value = (years * 12) + months;
                }
                isUpdating = false;
            }
            function updateYMFromTotal() {
                if (isUpdating) return;
                isUpdating = true;
                
                s4_y_m_months.classList.remove('input-error');
                s4_y_m_months_warning.textContent = "";

                const totalMonths = parseInt(s4_y_m_total_months.value) || 0;
                if (document.activeElement !== s4_y_m_years) {
                    s4_y_m_years.value = Math.floor(totalMonths / 12);
                }
                if (document.activeElement !== s4_y_m_months) {
                    s4_y_m_months.value = totalMonths % 12;
                }
                isUpdating = false;
            }
            s4_y_m_years.addEventListener('input', updateYMFromCompound);
            s4_y_m_months.addEventListener('input', updateYMFromCompound);
            s4_y_m_total_months.addEventListener('input', updateYMFromTotal);

            // ‡®∞‡©Ä‡®∏‡©à‡©±‡®ü ‡®¨‡®ü‡®®
            reset4_btn.addEventListener('click', () => {
                isUpdating = true; 
                s4_h_m_hours.value = ''; s4_h_m_minutes.value = ''; s4_h_m_total_minutes.value = '';
                s4_d_h_days.value = ''; s4_d_h_hours.value = ''; s4_d_h_total_hours.value = '';
                s4_m_w_months.value = ''; s4_m_w_weeks.value = ''; s4_m_w_total_weeks.value = '';
                s4_y_m_years.value = ''; s4_y_m_months.value = ''; s4_y_m_total_months.value = '';
                
                // ‡®µ‡®æ‡®∞‡®®‡®ø‡©∞‡®ó‡®æ‡®Ç ‡®µ‡©Ä ‡®∞‡©Ä‡®∏‡©à‡©±‡®ü ‡®ï‡®∞‡©ã
                s4_h_m_minutes.classList.remove('input-error');
                s4_h_m_minutes_warning.textContent = "";
                s4_d_h_hours.classList.remove('input-error');
                s4_d_h_hours_warning.textContent = "";
                s4_m_w_weeks.classList.remove('input-error');
                s4_m_w_weeks_warning.textContent = "";
                s4_y_m_months.classList.remove('input-error');
                s4_y_m_months_warning.textContent = "";
                
                isUpdating = false; 
            });

        });
    </script>
</body>
</html>

