<!DOCTYPE html>
<html lang="pa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ਟਾਈਮ ਕੈਲਕੁਲੇਟਰ (ਡਾਰਕ ਮੋਡ)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Flatpickr (ਸਿਰਫ਼ ਤਰੀਕ ਲਈ) CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <!-- [ਨਵਾਂ] Flatpickr ਡਾਰਕ ਥੀਮ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Noto+Sans+Gurmukhi:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* [ਨਵਾਂ] ਬ੍ਰਾਊਜ਼ਰ ਨੂੰ ਡਾਰਕ ਮੋਡ ਲਈ ਸੰਕੇਤ ਦਿਓ (ਸਮਾਂ ਚੁਣਨ ਵਾਲੇ ਲਈ) */
        html {
            color-scheme: dark;
        }
        body {
            font-family: 'Inter', 'Noto Sans Gurmukhi', sans-serif;
        }

        /* [ਬਦਲਿਆ] ਡਾਰਕ ਮੋਡ ਇਨਪੁਟ ਸਟਾਈਲ */
        .date-input, .time-input {
            background-color: #1f2937; /* bg-gray-800 */
            border-color: #4b5563;     /* border-gray-600 */
            color: #f9fafb;             /* text-gray-50 */
        }
        .date-input::placeholder {
            color: #9ca3af; /* text-gray-400 */
        }

        /* [ਬਦਲਿਆ] ਟਾਈਮ ਪਿਕਰ ਆਈਕਨ ਨੂੰ ਡਾਰਕ ਮੋਡ ਲਈ ਸਟਾਈਲ ਕਰੋ */
        input[type="time"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            min-height: 48px;
        }
        input[type="time"]::-webkit-calendar-picker-indicator {
            filter: invert(1) brightness(0.8); /* ਆਈਕਨ ਨੂੰ ਚਿੱਟਾ/ਹਲਕਾ ਸਲੇਟੀ ਬਣਾਓ */
        }
        
        .date-input-wrapper {
            position: relative;
            width: 100%;
        }
        .date-input-wrapper input {
            padding-right: 3rem;
        }
        /* [ਬਦਲਿਆ] ਕਸਟਮ ਕੈਲੰਡਰ ਆਈਕਨ ਸਟਾਈਲ */
        .date-input-wrapper .calendar-icon {
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: #9ca3af; /* text-gray-400 */
            z-index: 1; 
        }

        /* [ਨਵਾਂ] ਡਾਰਕ ਮੋਡ ਆਉਟਪੁੱਟ ਬਾਕਸ */
        .output-box {
            background-color: #111827; /* bg-gray-900 */
        }

        /* [ਨਵਾਂ] ਡਾਰਕ ਮੋਡ ਰੀਸੈੱਟ ਬਟਨ */
        .reset-button {
            background-color: #374151; /* bg-gray-700 */
            color: #d1d5db;             /* text-gray-300 */
        }
        .reset-button:hover {
            background-color: #4b5563; /* bg-gray-600 */
        }
    </style>
</head>
<body class="bg-black min-h-screen flex items-center justify-center p-4">
    <main class="w-full max-w-2xl space-y-8">
        <!-- ========================== -->
        <!-- ਸੈਕਸ਼ਨ 1: ਤਰੀਕ ਦਾ ਅੰਤਰ -->
        <!-- ========================== -->
        <section class="bg-gray-950 border-2 border-green-800 p-6 rounded-3xl shadow-lg">
            <h2 class="text-2xl font-bold text-green-400 text-center mb-5">ਸੈਕਸ਼ਨ 1: ਤਰੀਕ ਦਾ ਅੰਤਰ</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label for="s1-date1" class="block mb-1 font-semibold text-green-300">ਸ਼ੁਰੁਆਤੀ ਤਰੀਕ</label>
                    <div class="date-input-wrapper">
                        <input type="text" id="s1-date1" placeholder="DD-MM-YYYY" inputmode="tel" class="w-full p-3 rounded-xl border focus:ring-2 focus:ring-green-500 date-input" data-input> 
                        <span class="calendar-icon" data-toggle> 
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                            </svg>
                        </span>
                    </div>
                    <!-- ਚੇਤਾਵਨੀ ਸੁਨੇਹੇ ਲਈ ਥਾਂ -->
                    <p id="s1-date1-warning" class="text-red-500 text-sm mt-1 h-4"></p>
                </div>
                <div>
                    <label for="s1-date2" class="block mb-1 font-semibold text-green-300">ਅੰਤਿਮ ਤਰੀਕ</label>
                    <div class="date-input-wrapper">
                        <input type="text" id="s1-date2" placeholder="DD-MM-YYYY" inputmode="tel" class="w-full p-3 rounded-xl border focus:ring-2 focus:ring-green-500 date-input" data-input>
                        <span class="calendar-icon" data-toggle>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                            </svg>
                        </span>
                    </div>
                    <!-- ਚੇਤਾਵਨੀ ਸੁਨੇਹੇ ਲਈ ਥਾਂ -->
                    <p id="s1-date2-warning" class="text-red-500 text-sm mt-1 h-4"></p>
                </div>
            </div>
            <button id="calc1" class="w-full p-3 rounded-xl bg-green-700 text-white font-bold hover:bg-green-600 transition">
                ਗਣਨਾ ਕਰੋ
            </button>
            <div id="output-box1" class="mt-4 p-4 rounded-xl shadow-inner space-y-3 hidden output-box">
                <p id="result1" class="text-lg font-mono text-gray-100 text-center"></p>
                <div class="text-center">
                    <button id="reset1" class="px-4 py-2 rounded-lg text-sm font-medium transition reset-button">
                        ਰੀਸੈੱਟ
                    </button>
                </div>
            </div>
        </section>
        <!-- ========================== -->
        <!-- ਸੈਕਸ਼ਨ 2: ਸਮੇਂ ਦਾ ਅੰਤਰ -->
        <!-- ========================== -->
        <section class="bg-gray-950 border-2 border-purple-800 p-6 rounded-3xl shadow-lg">
            <h2 class="text-2xl font-bold text-purple-400 text-center mb-5">ਸੈਕਸ਼ਨ 2: ਸਮੇਂ ਦਾ ਅੰਤਰ</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label for="s2-time1" class="block mb-1 font-semibold text-purple-300">ਸ਼ੁਰੁਆਤੀ ਸਮਾਂ (HH:MM)</label>
                    <input type="time" id="s2-time1" class="w-full p-3 rounded-xl border focus:ring-2 focus:ring-purple-500 time-input" required>
                </div>
                <div>
                    <label for="s2-time2" class="block mb-1 font-semibold text-purple-300">ਅੰਤਿਮ ਸਮਾਂ (HH:MM)</label>
                    <input type="time" id="s2-time2" class="w-full p-3 rounded-xl border focus:ring-2 focus:ring-purple-500 time-input" required>
                </div>
            </div>
            <button id="calc2" class="w-full p-3 rounded-xl bg-purple-700 text-white font-bold hover:bg-purple-600 transition">
                ਗਣਨਾ ਕਰੋ
            </button>
            <div id="output-box2" class="mt-4 p-4 rounded-xl shadow-inner space-y-3 hidden output-box">
                <p id="result2" class="text-lg font-mono text-gray-100 text-center"></p>
                <div class="text-center">
                    <button id="reset2" class="px-4 py-2 rounded-lg text-sm font-medium transition reset-button">
                        ਰੀਸੈੱਟ
                    </button>
                </div>
            </div>
        </section>
        <!-- ========================== -->
        <!-- ਸੈਕਸ਼ਨ 3: ਕੁੱਲ ਅੰਤਰ -->
        <!-- ========================== -->
        <section class="bg-gray-950 border-2 border-blue-800 p-6 rounded-3xl shadow-lg">
            <h2 class="text-2xl font-bold text-blue-400 text-center mb-5">ਸੈਕਸ਼ਨ 3: ਕੁੱਲ ਅੰਤਰ</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                
                <!-- ਸ਼ੁਰੁਆਤੀ ਤਰੀਕ -->
                <div>
                    <label for="s3-date1" class="block mb-1 font-semibold text-blue-300">ਸ਼ੁਰੁਆਤੀ ਤਰੀਕ</label>
                    <div class="date-input-wrapper">
                        <input type="text" id="s3-date1" placeholder="DD-MM-YYYY" inputmode="tel" class="w-full p-3 rounded-xl border focus:ring-2 focus:ring-blue-500 date-input" data-input>
                        <span class="calendar-icon" data-toggle>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                            </svg>
                        </span>
                    </div>
                    <p id="s3-date1-warning" class="text-red-500 text-sm mt-1 h-4"></p>
                </div>
                
                <!-- ਸ਼ੁਰੁਆਤੀ ਸਮਾਂ -->
                <div>
                    <label for="s3-time1" class="block mb-1 font-semibold text-blue-300">ਸ਼ੁਰੁਆਤੀ ਸਮਾਂ (HH:MM)</label>
                    <input type="time" id="s3-time1" class="w-full p-3 rounded-xl border focus:ring-2 focus:ring-blue-500 time-input" required>
                </div>

                <!-- ਅੰਤਿਮ ਤਰੀਕ -->
                <div>
                    <label for="s3-date2" class="block mb-1 font-semibold text-blue-300">ਅੰਤਿਮ ਤਰੀਕ</label>
                    <div class="date-input-wrapper">
                        <input type="text" id="s3-date2" placeholder="DD-MM-YYYY" inputmode="tel" class="w-full p-3 rounded-xl border focus:ring-2 focus:ring-blue-500 date-input" data-input>
                        <span class="calendar-icon" data-toggle>
                             <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                            </svg>
                        </span>
                    </div>
                    <p id="s3-date2-warning" class="text-red-500 text-sm mt-1 h-4"></p>
                </div>
                
                <!-- ਅੰਤਿਮ ਸਮਾਂ -->
                <div>
                    <label for="s3-time2" class="block mb-1 font-semibold text-blue-300">ਅੰਤਿਮ ਸਮਾਂ (HH:MM)</label>
                    <input type="time" id="s3-time2" class="w-full p-3 rounded-xl border focus:ring-2 focus:ring-blue-500 time-input" required>
                </div>
            </div>
            
            <button id="calc3" class="w-full p-3 rounded-xl bg-blue-700 text-white font-bold hover:bg-blue-600 transition">
                ਗਣਨਾ ਕਰੋ
            </button>
            <div id="output-box3" class="mt-4 p-4 rounded-xl shadow-inner space-y-3 hidden output-box">
                <p id="result3-ymd" class="text-lg font-mono text-gray-100 text-center"></p>
                <p id="result3-hms" class="text-lg font-mono text-gray-100 text-center"></p>
                <hr class="my-2 border-gray-700">
                <p id="result3-total-dhm" class="text-md font-mono text-gray-100 text-center"></p>
                <p id="result3-total_h" class="text-md font-mono text-gray-100 text-center"></p>
                <div class="text-center">
                    <button id="reset3" class="px-4 py-2 rounded-lg text-sm font-medium transition reset-button">
                        ਰੀਸੈੱਟ
                    </button>
                </div>
            </div>
        </section>
    </main>
    <script>
        // --- ਸਾਰਾ JavaScript ਕੋਡ (ਪਹਿਲਾਂ ਵਾਂਗ ਹੀ) ---
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- Flatpickr (ਸਿਰਫ਼ ਤਰੀਕ ਲਈ) ਸ਼ੁਰੂ ਕਰਨਾ ---
            document.querySelectorAll('.date-input-wrapper').forEach(wrapper => {
                flatpickr(wrapper, {
                    wrap: true,             
                    allowInput: true,       
                    disableMobile: true,    
                    dateFormat: "d-m-Y",    
                    clickOpens: false       
                });
            });

            // --- [ਅੰਤਿਮ] ਸਵੈ-ਚਲਿਤ ਹਾਈਫਨ (-) ਅਤੇ ਚੇਤਾਵਨੀ ਸਿਸਟਮ ---
            document.querySelectorAll('input[data-input]').forEach(input => {
                input.addEventListener('input', (e) => {
                    if (!e.isTrusted) return; 
                    
                    const target = e.target;
                    const originalValue = target.value;
                    let value = originalValue.replace(/[^\d]/g, ''); // ਸਿਰਫ਼ ਅੰਕ ਰੱਖੋ

                    // ਆਟੋ-ਹਾਈਫਨ ਫਾਰਮੈਟਿੰਗ
                    let formattedValue = '';
                    if (value.length > 0) {
                        if (value.length <= 2) {
                            formattedValue = value;
                        } else if (value.length <= 4) {
                            formattedValue = `${value.substring(0, 2)}-${value.substring(2)}`;
                        } else {
                            formattedValue = `${value.substring(0, 2)}-${value.substring(2, 4)}-${value.substring(4, 8)}`;
                        }
                    }
                    
                    if (originalValue !== formattedValue) {
                        target.value = formattedValue;
                    }

                    // --- [ਨਵਾਂ] "31 ਅਪ੍ਰੈਲ" ਲਈ ਚੇਤਾਵਨੀ ਲਾਜਿਕ ---
                    const warningElement = document.getElementById(target.id + '-warning');
                    if (!warningElement) return; 

                    warningElement.textContent = ''; // ਪਿਛਲੀ ਚੇਤਾਵਨੀ ਸਾਫ਼ ਕਰੋ
                    
                    const parts = formattedValue.split('-');
                    let dayError = false;
                    let monthError = false;
                    let dateInvalidError = false; // "31 ਅਪ੍ਰੈਲ" ਲਈ
                    let invalidErrorMsg = "";

                    let dayNum = 0;
                    let monthNum = 0;

                    // 1. ਦਿਨ (Day) ਦੀ ਜਾਂਚ
                    if (parts[0] && parts[0].length > 0) {
                        dayNum = parseInt(parts[0]);
                        if (dayNum > 31 || (parts[0].length === 2 && dayNum === 0)) {
                            dayError = true;
                        }
                    }

                    // 2. ਮਹੀਨੇ (Month) ਦੀ ਜਾਂਚ
                    if (parts[1] && parts[1].length > 0) {
                        monthNum = parseInt(parts[1]);
                        if (monthNum > 12 || (parts[1].length === 2 && monthNum === 0)) {
                            monthError = true;
                        }
                    }

                    // 3. [ਨਵਾਂ] "ਮਹੀਨੇ ਦੇ ਦਿਨ" (Days in Month) ਦੀ ਜਾਂਚ
                    if (!dayError && !monthError && dayNum > 0 && monthNum > 0 && parts[1].length === 2) {
                        const shortMonths = [4, 6, 9, 11]; // 30 ਦਿਨਾਂ ਵਾਲੇ ਮਹੀਨੇ (ਅਪ੍ਰੈਲ, ਜੂਨ, ਸਤੰਬਰ, ਨਵੰਬਰ)
                        
                        // 30 ਦਿਨਾਂ ਵਾਲੇ ਮਹੀਨੇ ਵਿੱਚ 31 ਤਰੀਕ ਦੀ ਜਾਂਚ
                        if (dayNum === 31 && shortMonths.includes(monthNum)) {
                            dateInvalidError = true;
                            invalidErrorMsg = "ਇਸ ਮਹੀਨੇ ਵਿੱਚ 31 ਤਰੀਕ ਨਹੀਂ ਹੁੰਦੀ।";
                        }
                        
                        // ਫਰਵਰੀ ਦੀ ਜਾਂਚ
                        if (monthNum === 2 && dayNum > 29) { // 30 ਜਾਂ 31 ਫਰਵਰੀ
                            dateInvalidError = true;
                            invalidErrorMsg = "ਫਰਵਰੀ ਵਿੱਚ 29 ਤੋਂ ਵੱਧ ਦਿਨ ਨਹੀਂ ਹੁੰਦੇ।";
                        }
                    }

                    // 4. ਚੇਤਾਵਨੀ ਸੁਨੇਹਾ ਦਿਖਾਓ
                    if (dayError) {
                        warningElement.textContent = "ਦਿਨ 01-31 ਦੇ ਵਿਚਕਾਰ ਹੋਣਾ ਚਾਹੀਦਾ ਹੈ।";
                    } else if (monthError) {
                        warningElement.textContent = "ਮਹੀਨਾ 01-12 ਦੇ ਵਿਚਕਾਰ ਹੋਣਾ ਚਾਹੀਦਾ ਹੈ।";
                    } else if (dateInvalidError) {
                        warningElement.textContent = invalidErrorMsg; // ਨਵਾਂ ਸੁਨੇਹਾ
                    }
                });
            });

            // --- 'ਗਣਨਾ ਕਰੋ' ਬਟਨ ਲਈ Helper Function (ਇਹ '29 ਫਰਵਰੀ 2023' ਵਰਗੀਆਂ ਗਲਤੀਆਂ ਫੜਦਾ ਹੈ) ---
            function parseDate(dateStr) {
                if (!dateStr || dateStr.length < 10) return null; 

                const parts = dateStr.split('-');
                if (parts.length !== 3) return null;
                
                if (parts.some(p => isNaN(Number(p)) || p === '')) {
                    return null;
                }

                const [day, month, year] = parts.map(Number);

                if (month < 1 || month > 12) { return null; }
                if (day < 1 || day > 31) { return null; }
                if (year < 1000 || year > 9999) { return null; }

                const dateObj = new Date(year, month - 1, day);

                // [ਅੰਤਿਮ ਜਾਂਚ] '29 ਫਰਵਰੀ 2023' (ਲੀਪ ਸਾਲ ਨਾ ਹੋਣ) ਵਰਗੀਆਂ ਸਾਰੀਆਂ ਗਲਤੀਆਂ ਫੜਦਾ ਹੈ
                if (dateObj.getFullYear() !== year || 
                    dateObj.getMonth() !== (month - 1) || 
                    dateObj.getDate() !== day) 
                {
                    console.log(`ਅੰਤਿਮ ਜਾਂਚ ਫੇਲ੍ਹ: ${day}-${month}-${year}`);
                    return null; // ਇਹ ਇੱਕ ਅਵੈਧ ਮਿਤੀ ਹੈ
                }

                return dateObj;
            }

            function parseTime(timeStr) {
                if (!timeStr) return null; 
                const parts = timeStr.split(':');
                if (parts.length !== 2 || parts.some(p => p === '' || isNaN(p))) return null; 
                const h = parseInt(parts[0]);
                const m = parseInt(parts[1]);
                if (h < 0 || h > 23 || m < 0 || m > 59) return null; 
                const s = 0; 
                return { h, m, s };
            }

            function daysInMonth(year, month) {
                return new Date(year, month + 1, 0).getDate();
            }
            
            // --- UI ਤੱਤ ਅਤੇ ਈਵੈਂਟ ਲਿਸਨਰ ---
            
            // (ਸੈਕਸ਼ਨ 1 ਦੇ ਤੱਤ)
            const s1_date1 = document.getElementById('s1-date1');
            const s1_date2 = document.getElementById('s1-date2');
            const calc1_btn = document.getElementById('calc1');
            const result1 = document.getElementById('result1');
            const output_box1 = document.getElementById('output-box1');
            const reset1_btn = document.getElementById('reset1');
            // (ਸੈਕਸ਼ਨ 2 ਦੇ ਤੱਤ)
            const s2_time1 = document.getElementById('s2-time1');
            const s2_time2 = document.getElementById('s2-time2');
            const calc2_btn = document.getElementById('calc2');
            const result2 = document.getElementById('result2');
            const output_box2 = document.getElementById('output-box2');
            const reset2_btn = document.getElementById('reset2');
            // (ਸੈਕਸ਼ਨ 3 ਦੇ ਤੱਤ)
            const s3_date1 = document.getElementById('s3-date1');
            const s3_date2 = document.getElementById('s3-date2');
            const s3_time1 = document.getElementById('s3-time1');
            const s3_time2 = document.getElementById('s3-time2');
            const calc3_btn = document.getElementById('calc3');
            const result3_ymd = document.getElementById('result3-ymd');
            const result3_hms = document.getElementById('result3-hms');
            const result3_total_dhm = document.getElementById('result3-total-dhm');
            const result3_total_h = document.getElementById('result3-total_h');
            const output_box3 = document.getElementById('output-box3');
            const reset3_btn = document.getElementById('reset3');
            
            // ਸੈਕਸ਼ਨ 1: ਗਣਨਾ (ਬਟਨ ਕਲਿੱਕ)
            calc1_btn.addEventListener('click', () => {
                document.getElementById('s1-date1-warning').textContent = '';
                document.getElementById('s1-date2-warning').textContent = '';

                const d1 = parseDate(s1_date1.value);
                const d2 = parseDate(s1_date2.value);
                
                if (!d1 || !d2) {
                    result1.textContent = "ਤਰੀਕ ਸਹੀ ਭਰੋ (ਜਿਵੇਂ 29-02-2023 ਗਲਤ ਹੈ)";
                    output_box1.classList.remove('hidden');
                    return;
                }
                let startDate = d1 < d2 ? d1 : d2;
                let endDate = d1 > d2 ? d1 : d2;
                
                let years = endDate.getFullYear() - startDate.getFullYear();
                let months = endDate.getMonth() - startDate.getMonth();
                let days = endDate.getDate() - startDate.getDate();
                
                if (days < 0) {
                    months--;
                    days += daysInMonth(startDate.getFullYear(), startDate.getMonth());
                }
                if (months < 0) {
                    years--;
                    months += 12;
                }
                result1.textContent = `ਅੰਤਰ: ${years} ਸਾਲ ${months} ਮਹੀਨੇ ${days} ਦਿਨ`;
                output_box1.classList.remove('hidden');
            });
            reset1_btn.addEventListener('click', () => {
                s1_date1.value = '';
                s1_date2.value = '';
                result1.textContent = '';
                output_box1.classList.add('hidden');
                document.getElementById('s1-date1-warning').textContent = '';
                document.getElementById('s1-date2-warning').textContent = '';
            });
            
            // ਸੈਕਸ਼ਨ 2: ਗਣਨਾ
            calc2_btn.addEventListener('click', () => {
                const t1 = parseTime(s2_time1.value);
                const t2 = parseTime(s2_time2.value);
                if (!t1 || !t2) {
                    result2.textContent = "ਸਮਾਂ ਸਹੀ ਭਰੋ";
                    output_box2.classList.remove('hidden');
                    return;
                }
                let totalSeconds1 = t1.h * 3600 + t1.m * 60;
                let totalSeconds2 = t2.h * 3600 + t2.m * 60;
                
                let diffSeconds = Math.abs(totalSeconds1 - totalSeconds2);
                let h = Math.floor(diffSeconds / 3600);
                diffSeconds %= 3600;
                let m = Math.floor(diffSeconds / 60);
                
                result2.textContent = `ਅੰਤਰ: ${h} ਘੰਟੇ ${m} ਮਿੰਟ`;
                output_box2.classList.remove('hidden');
            });
            reset2_btn.addEventListener('click', () => {
                s2_time1.value = '';
                s2_time2.value = '';
                result2.textContent = '';
                output_box2.classList.add('hidden');
            });
            
            // ਸੈਕਸ਼ਨ 3: ਗਣਨਾ
            calc3_btn.addEventListener('click', () => {
                document.getElementById('s3-date1-warning').textContent = '';
                document.getElementById('s3-date2-warning').textContent = '';

                const d1 = parseDate(s3_date1.value);
                const d2 = parseDate(s3_date2.value);
                
                if (!d1 || !d2) {
                    result3_ymd.textContent = "ਤਰੀਕ ਸਹੀ ਭਰੋ";
                    result3_hms.textContent = "";
                    result3_total_dhm.textContent = "";
                    result3_total_h.textContent = "";
                    output_box3.classList.remove('hidden');
                    return;
                }
                
                const t1 = parseTime(s3_time1.value);
                const t2 = parseTime(s3_time2.value);

                if (!t1 || !t2) {
                    result3_ymd.textContent = "ਸਮਾਂ ਸਹੀ ਭਰੋ";
                    result3_hms.textContent = "";
                    result3_total_dhm.textContent = "";
                    result3_total_h.textContent = "";
                    output_box3.classList.remove('hidden');
                    return;
                }

                const dt1 = new Date(d1.getFullYear(), d1.getMonth(), d1.getDate(), t1.h, t1.m);
                const dt2 = new Date(d2.getFullYear(), d2.getMonth(), d2.getDate(), t2.h, t2.m);
                let startDate = dt1 < dt2 ? dt1 : dt2;
                let endDate = dt1 > d2 ? dt1 : dt2;
                
                let diffMs = Math.abs(dt2 - dt1);
                // ਗਣਨਾ 1 & 2
                let years = endDate.getFullYear() - startDate.getFullYear();
                let months = endDate.getMonth() - startDate.getMonth();
                let days = endDate.getDate() - startDate.getDate();
                let hours = endDate.getHours() - startDate.getHours();
                let minutes = endDate.getMinutes() - startDate.getMinutes();
                
                if (minutes < 0) { hours--; minutes += 60; }
                if (hours < 0) { days--; hours += 24; }
                if (days < 0) {
                    months--;
                    days += daysInMonth(startDate.getFullYear(), startDate.getMonth());
                }
                if (months < 0) { years--; months += 12; }
                
                result3_ymd.textContent = `ਅੰਤਰ: ${years} ਸਾਲ ${months} ਮਹੀਨੇ ${days} ਦਿਨ`;
                result3_hms.textContent = `ਅਤੇ ${hours} ਘੰਟੇ ${minutes} ਮਿੰਟ`;
                // ਗਣਨਾ 3
                let totalDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
                let remMs = diffMs % (1000 * 60 * 60 * 24);
                let totalHours = Math.floor(remMs / (1000 * 60 * 60));
                remMs %= (1000 * 60 * 60);
                let totalMinutes = Math.floor(remMs / (1000 * 60));
                
                result3_total_dhm.textContent = `ਕੁੱਲ: ${totalDays} ਦਿਨ, ${totalHours} ਘੰਟੇ ਅਤੇ ${totalMinutes} ਮਿੰਟ`;
                // ਗਣਨਾ 4
                let totalHoursOnly = (diffMs / (1000 * 60 * 60)).toFixed(2);
                result3_total_h.textContent = `ਜਾਂ ਕੁੱਲ ${totalHoursOnly} ਘੰਟੇ`;
                output_box3.classList.remove('hidden');
            });
            reset3_btn.addEventListener('click', () => {
                s3_date1.value = '';
                s3_date2.value = '';
                s3_time1.value = '';
                s3_time2.value = '';
                
                result3_ymd.textContent = '';
                result3_hms.textContent = '';
                result3_total_dhm.textContent = '';
                result3_total_h.textContent = '';
                output_box3.classList.add('hidden');
                document.getElementById('s3-date1-warning').textContent = '';
                document.getElementById('s3-date2-warning').textContent = '';
            });
        });
    </script>
</body>
</html>

